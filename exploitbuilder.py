# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'exploitBuilder.ui'
#
# Created by: PyQt4 UI code generator 4.11.4
#
# WARNING! All changes made in this file will be lost!

from PyQt4 import QtCore, QtGui
import subprocess
import base64
        
## constant strings declared and handled by gui ##
warning_msg = 'input must be a positive integer!'
pattern_create_path='/usr/share/metasploit-framework/tools/exploit/pattern_create.rb'
pattern_locate_path='/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb'
payloads = ['','windows/meterpreter/reverse_tcp', 'linux/x86/meterpreter/reverse_tcp', 'osx/x86/shell_reverse_tcp']
payload_format =[ '','exe', 'elf', 'macho']
encoders=['','x86/shikata_ga_nai', 'cmd/powershell_base64',' x86/fnstenv_mov']
exit_func_list=['','thread','process','seh']
## end of constant strings declaration ##

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    def _fromUtf8(s):
        return s

try:
    _encoding = QtGui.QApplication.UnicodeUTF8
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig, _encoding)
except AttributeError:
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig)

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName(_fromUtf8("Dialog"))
        Dialog.resize(843, 948)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(Dialog.sizePolicy().hasHeightForWidth())
        Dialog.setSizePolicy(sizePolicy)
        self.verticalLayout = QtGui.QVBoxLayout(Dialog)
        self.verticalLayout.setObjectName(_fromUtf8("verticalLayout"))
        self.horizontalLayout_13 = QtGui.QHBoxLayout()
        self.horizontalLayout_13.setObjectName(_fromUtf8("horizontalLayout_13"))
        self.pc_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_label.sizePolicy().hasHeightForWidth())
        self.pc_label.setSizePolicy(sizePolicy)
        self.pc_label.setMinimumSize(QtCore.QSize(116, 0))
        self.pc_label.setAlignment(QtCore.Qt.AlignCenter)
        self.pc_label.setObjectName(_fromUtf8("pc_label"))
        self.horizontalLayout_13.addWidget(self.pc_label)
        self.pc_bytes_lineEdit = QtGui.QLineEdit(Dialog)
        self.pc_bytes_lineEdit.setObjectName(_fromUtf8("pc_bytes_lineEdit"))
        self.horizontalLayout_13.addWidget(self.pc_bytes_lineEdit)
        self.pc_bytes_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_bytes_label.sizePolicy().hasHeightForWidth())
        self.pc_bytes_label.setSizePolicy(sizePolicy)
        self.pc_bytes_label.setMinimumSize(QtCore.QSize(83, 0))
        self.pc_bytes_label.setMaximumSize(QtCore.QSize(85, 16777215))
        self.pc_bytes_label.setAlignment(QtCore.Qt.AlignCenter)
        self.pc_bytes_label.setObjectName(_fromUtf8("pc_bytes_label"))
        self.horizontalLayout_13.addWidget(self.pc_bytes_label)
        self.verticalLayout.addLayout(self.horizontalLayout_13)
        self.horizontalLayout_12 = QtGui.QHBoxLayout()
        self.horizontalLayout_12.setObjectName(_fromUtf8("horizontalLayout_12"))
        self.pc_out_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_out_label.sizePolicy().hasHeightForWidth())
        self.pc_out_label.setSizePolicy(sizePolicy)
        self.pc_out_label.setMinimumSize(QtCore.QSize(116, 0))
        self.pc_out_label.setAlignment(QtCore.Qt.AlignCenter)
        self.pc_out_label.setObjectName(_fromUtf8("pc_out_label"))
        self.horizontalLayout_12.addWidget(self.pc_out_label)
        self.pc_out_textBrowser = QtGui.QTextBrowser(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Minimum)
        
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_out_textBrowser.sizePolicy().hasHeightForWidth())
        self.pc_out_textBrowser.setSizePolicy(sizePolicy)
        self.pc_out_textBrowser.setMinimumSize(QtCore.QSize(0, 27))
        self.pc_out_textBrowser.setObjectName(_fromUtf8("pc_out_textBrowser"))
        self.horizontalLayout_12.addWidget(self.pc_out_textBrowser)
        self.pc_create_pushButton = QtGui.QPushButton(Dialog)
        self.pc_create_pushButton.setObjectName(_fromUtf8("pc_create_pushButton"))
        ##
        ##
        ##
        self.horizontalLayout_12.addWidget(self.pc_create_pushButton)
        self.verticalLayout.addLayout(self.horizontalLayout_12)
        self.line = QtGui.QFrame(Dialog)
        self.line.setFrameShape(QtGui.QFrame.HLine)
        self.line.setFrameShadow(QtGui.QFrame.Sunken)
        self.line.setObjectName(_fromUtf8("line"))
        self.verticalLayout.addWidget(self.line)
        self.horizontalLayout_11 = QtGui.QHBoxLayout()
        self.horizontalLayout_11.setObjectName(_fromUtf8("horizontalLayout_11"))
        self.poffset_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.poffset_label.sizePolicy().hasHeightForWidth())
        self.poffset_label.setSizePolicy(sizePolicy)
        self.poffset_label.setMinimumSize(QtCore.QSize(116, 0))
        self.poffset_label.setAlignment(QtCore.Qt.AlignCenter)
        self.poffset_label.setObjectName(_fromUtf8("poffset_label"))
        self.horizontalLayout_11.addWidget(self.poffset_label)
        self.poffset_bytes_lineEdit = QtGui.QLineEdit(Dialog)
        self.poffset_bytes_lineEdit.setObjectName(_fromUtf8("poffset_bytes_lineEdit"))
        self.horizontalLayout_11.addWidget(self.poffset_bytes_lineEdit)
        self.poffset_bytes_label = QtGui.QLabel(Dialog)
        self.poffset_bytes_label.setObjectName(_fromUtf8("poffset_bytes_label"))
        self.horizontalLayout_11.addWidget(self.poffset_bytes_label)
        self.poffset_pattern_lineEdit = QtGui.QLineEdit(Dialog)
        self.poffset_pattern_lineEdit.setObjectName(_fromUtf8("poffset_pattern_lineEdit"))
        self.horizontalLayout_11.addWidget(self.poffset_pattern_lineEdit)
        self.pattern_in_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pattern_in_label.sizePolicy().hasHeightForWidth())
        self.pattern_in_label.setSizePolicy(sizePolicy)
        self.pattern_in_label.setMinimumSize(QtCore.QSize(83, 0))
        self.pattern_in_label.setAlignment(QtCore.Qt.AlignCenter)
        self.pattern_in_label.setObjectName(_fromUtf8("pattern_in_label"))
        self.horizontalLayout_11.addWidget(self.pattern_in_label)
        self.verticalLayout.addLayout(self.horizontalLayout_11)
        self.horizontalLayout_10 = QtGui.QHBoxLayout()
        self.horizontalLayout_10.setObjectName(_fromUtf8("horizontalLayout_10"))
        self.pc_out_label_2 = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_out_label_2.sizePolicy().hasHeightForWidth())
        self.pc_out_label_2.setSizePolicy(sizePolicy)
        self.pc_out_label_2.setMinimumSize(QtCore.QSize(116, 0))
        self.pc_out_label_2.setAlignment(QtCore.Qt.AlignCenter)
        self.pc_out_label_2.setObjectName(_fromUtf8("pc_out_label_2"))
        self.horizontalLayout_10.addWidget(self.pc_out_label_2)
        self.pc_out_textBrowser_2 = QtGui.QTextBrowser(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.pc_out_textBrowser_2.sizePolicy().hasHeightForWidth())
        self.pc_out_textBrowser_2.setSizePolicy(sizePolicy)
        self.pc_out_textBrowser_2.setMinimumSize(QtCore.QSize(0, 27))
        self.pc_out_textBrowser_2.setObjectName(_fromUtf8("pc_out_textBrowser_2"))
        self.horizontalLayout_10.addWidget(self.pc_out_textBrowser_2)
        self.pc_locate_pushButton = QtGui.QPushButton(Dialog)
        self.pc_locate_pushButton.setObjectName(_fromUtf8("pc_locate_pushButton"))
        ##
        ##
        ##
        self.horizontalLayout_10.addWidget(self.pc_locate_pushButton)
        self.verticalLayout.addLayout(self.horizontalLayout_10)
        self.line_3 = QtGui.QFrame(Dialog)
        self.line_3.setFrameShape(QtGui.QFrame.HLine)
        self.line_3.setFrameShadow(QtGui.QFrame.Sunken)
        self.line_3.setObjectName(_fromUtf8("line_3"))
        self.verticalLayout.addWidget(self.line_3)
        self.horizontalLayout_9 = QtGui.QHBoxLayout()
        self.horizontalLayout_9.setObjectName(_fromUtf8("horizontalLayout_9"))
        self.b64_enc_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.b64_enc_label.sizePolicy().hasHeightForWidth())
        self.b64_enc_label.setSizePolicy(sizePolicy)
        self.b64_enc_label.setMinimumSize(QtCore.QSize(116, 0))
        self.b64_enc_label.setAlignment(QtCore.Qt.AlignCenter)
        self.b64_enc_label.setObjectName(_fromUtf8("b64_enc_label"))
        self.horizontalLayout_9.addWidget(self.b64_enc_label)
        self.b64_encode_lineEdit = QtGui.QLineEdit(Dialog)
        self.b64_encode_lineEdit.setObjectName(_fromUtf8("b64_encode_lineEdit"))
        self.horizontalLayout_9.addWidget(self.b64_encode_lineEdit)
        self.b64_encode_pushButton = QtGui.QPushButton(Dialog)
        self.b64_encode_pushButton.setObjectName(_fromUtf8("b64_encode_pushButton"))
        ##
        ##
        ##
        self.horizontalLayout_9.addWidget(self.b64_encode_pushButton)
        self.verticalLayout.addLayout(self.horizontalLayout_9)
        self.horizontalLayout_8 = QtGui.QHBoxLayout()
        self.horizontalLayout_8.setObjectName(_fromUtf8("horizontalLayout_8"))
        self.b64_encoded_out_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.b64_encoded_out_label.sizePolicy().hasHeightForWidth())
        self.b64_encoded_out_label.setSizePolicy(sizePolicy)
        self.b64_encoded_out_label.setMinimumSize(QtCore.QSize(116, 0))
        self.b64_encoded_out_label.setAlignment(QtCore.Qt.AlignCenter)
        self.b64_encoded_out_label.setObjectName(_fromUtf8("b64_encoded_out_label"))
        self.horizontalLayout_8.addWidget(self.b64_encoded_out_label)
        self.textBrowser_2 = QtGui.QTextBrowser(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.textBrowser_2.sizePolicy().hasHeightForWidth())
        self.textBrowser_2.setSizePolicy(sizePolicy)
        self.textBrowser_2.setMaximumSize(QtCore.QSize(16777215, 27))
        self.textBrowser_2.setObjectName(_fromUtf8("textBrowser_2"))
        self.horizontalLayout_8.addWidget(self.textBrowser_2)
        self.verticalLayout.addLayout(self.horizontalLayout_8)
        self.line_4 = QtGui.QFrame(Dialog)
        self.line_4.setFrameShape(QtGui.QFrame.HLine)
        self.line_4.setFrameShadow(QtGui.QFrame.Sunken)
        self.line_4.setObjectName(_fromUtf8("line_4"))
        self.verticalLayout.addWidget(self.line_4)
        self.horizontalLayout_7 = QtGui.QHBoxLayout()
        self.horizontalLayout_7.setObjectName(_fromUtf8("horizontalLayout_7"))
        self.b64_enc_label_2 = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.b64_enc_label_2.sizePolicy().hasHeightForWidth())
        self.b64_enc_label_2.setSizePolicy(sizePolicy)
        self.b64_enc_label_2.setMinimumSize(QtCore.QSize(116, 0))
        self.b64_enc_label_2.setAlignment(QtCore.Qt.AlignCenter)
        self.b64_enc_label_2.setObjectName(_fromUtf8("b64_enc_label_2"))
        self.horizontalLayout_7.addWidget(self.b64_enc_label_2)
        self.b64_decode_lineEdit = QtGui.QLineEdit(Dialog)
        self.b64_decode_lineEdit.setObjectName(_fromUtf8("b64_decode_lineEdit"))
        self.horizontalLayout_7.addWidget(self.b64_decode_lineEdit)
        self.b64_encode_pushButton_2 = QtGui.QPushButton(Dialog)
        self.b64_encode_pushButton_2.setObjectName(_fromUtf8("b64_encode_pushButton_2"))
        self.horizontalLayout_7.addWidget(self.b64_encode_pushButton_2)
        self.verticalLayout.addLayout(self.horizontalLayout_7)
        self.horizontalLayout = QtGui.QHBoxLayout()
        self.horizontalLayout.setObjectName(_fromUtf8("horizontalLayout"))
        self.b64_decoded_out_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.b64_decoded_out_label.sizePolicy().hasHeightForWidth())
        self.b64_decoded_out_label.setSizePolicy(sizePolicy)
        self.b64_decoded_out_label.setMinimumSize(QtCore.QSize(116, 0))
        self.b64_decoded_out_label.setAlignment(QtCore.Qt.AlignCenter)
        self.b64_decoded_out_label.setObjectName(_fromUtf8("b64_decoded_out_label"))
        self.horizontalLayout.addWidget(self.b64_decoded_out_label)
        self.b64_dec_textBrowser = QtGui.QTextBrowser(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.b64_dec_textBrowser.sizePolicy().hasHeightForWidth())
        #b64 decode out
        self.b64_dec_textBrowser.setSizePolicy(sizePolicy)
        self.b64_dec_textBrowser.setMaximumSize(QtCore.QSize(16777215, 27))
        self.b64_dec_textBrowser.setObjectName(_fromUtf8("b64_dec_textBrowser"))
        self.horizontalLayout.addWidget(self.b64_dec_textBrowser)
        self.verticalLayout.addLayout(self.horizontalLayout)
        self.line_2 = QtGui.QFrame(Dialog)
        self.line_2.setFrameShape(QtGui.QFrame.HLine)
        self.line_2.setFrameShadow(QtGui.QFrame.Sunken)
        self.line_2.setObjectName(_fromUtf8("line_2"))
        self.verticalLayout.addWidget(self.line_2)
        self.horizontalLayout_2 = QtGui.QHBoxLayout()
        self.horizontalLayout_2.setObjectName(_fromUtf8("horizontalLayout_2"))
        self.payload_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.payload_label.sizePolicy().hasHeightForWidth())
        self.payload_label.setSizePolicy(sizePolicy)
        self.payload_label.setMinimumSize(QtCore.QSize(116, 0))
        self.payload_label.setAlignment(QtCore.Qt.AlignCenter)
        self.payload_label.setObjectName(_fromUtf8("payload_label"))
        self.horizontalLayout_2.addWidget(self.payload_label)
        self.payload_comboBox = QtGui.QComboBox(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Expanding, QtGui.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.payload_comboBox.sizePolicy().hasHeightForWidth())
        self.payload_comboBox.setSizePolicy(sizePolicy)
        self.payload_comboBox.setMinimumSize(QtCore.QSize(441, 0))
        self.payload_comboBox.setObjectName(_fromUtf8("payload_comboBox"))
        self.horizontalLayout_2.addWidget(self.payload_comboBox)
        self.verticalLayout.addLayout(self.horizontalLayout_2)
        self.horizontalLayout_3 = QtGui.QHBoxLayout()
        self.horizontalLayout_3.setObjectName(_fromUtf8("horizontalLayout_3"))
        self.lhost_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.lhost_label.sizePolicy().hasHeightForWidth())
        self.lhost_label.setSizePolicy(sizePolicy)
        self.lhost_label.setMinimumSize(QtCore.QSize(116, 0))
        self.lhost_label.setAlignment(QtCore.Qt.AlignCenter)
        self.lhost_label.setObjectName(_fromUtf8("lhost_label"))
        self.horizontalLayout_3.addWidget(self.lhost_label)
        self.lhost_lineEdit = QtGui.QLineEdit(Dialog)
        self.lhost_lineEdit.setObjectName(_fromUtf8("lhost_lineEdit"))
        self.horizontalLayout_3.addWidget(self.lhost_lineEdit)
        self.lport_label = QtGui.QLabel(Dialog)
        self.lport_label.setObjectName(_fromUtf8("lport_label"))
        self.horizontalLayout_3.addWidget(self.lport_label)
        self.lport_lineEdit = QtGui.QLineEdit(Dialog)
        self.lport_lineEdit.setObjectName(_fromUtf8("lport_lineEdit"))
        self.horizontalLayout_3.addWidget(self.lport_lineEdit)
        self.format_label = QtGui.QLabel(Dialog)
        self.format_label.setObjectName(_fromUtf8("format_label"))
        self.horizontalLayout_3.addWidget(self.format_label)
        self.format_comboBox = QtGui.QComboBox(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Fixed)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.format_comboBox.sizePolicy().hasHeightForWidth())
        self.format_comboBox.setSizePolicy(sizePolicy)
        self.format_comboBox.setMinimumSize(QtCore.QSize(85, 0))
        self.format_comboBox.setObjectName(_fromUtf8("format_comboBox"))
        self.horizontalLayout_3.addWidget(self.format_comboBox)
        self.verticalLayout.addLayout(self.horizontalLayout_3)
        self.horizontalLayout_4 = QtGui.QHBoxLayout()
        self.horizontalLayout_4.setObjectName(_fromUtf8("horizontalLayout_4"))
        self.fout_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.fout_label.sizePolicy().hasHeightForWidth())
        self.fout_label.setSizePolicy(sizePolicy)
        self.fout_label.setMinimumSize(QtCore.QSize(116, 0))
        self.fout_label.setAlignment(QtCore.Qt.AlignCenter)
        self.fout_label.setObjectName(_fromUtf8("fout_label"))
        self.horizontalLayout_4.addWidget(self.fout_label)
        self.fout_lineEdit = QtGui.QLineEdit(Dialog)
        self.fout_lineEdit.setObjectName(_fromUtf8("fout_lineEdit"))
        self.horizontalLayout_4.addWidget(self.fout_lineEdit)
        self.browse_fout_pushButton = QtGui.QPushButton(Dialog)
        self.browse_fout_pushButton.setObjectName(_fromUtf8("browse_fout_pushButton"))
        self.horizontalLayout_4.addWidget(self.browse_fout_pushButton)
        self.verticalLayout.addLayout(self.horizontalLayout_4)
        self.horizontalLayout_5 = QtGui.QHBoxLayout()
        self.horizontalLayout_5.setObjectName(_fromUtf8("horizontalLayout_5"))
        self.bad_chars_label = QtGui.QLabel(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.bad_chars_label.sizePolicy().hasHeightForWidth())
        self.bad_chars_label.setSizePolicy(sizePolicy)
        self.bad_chars_label.setMinimumSize(QtCore.QSize(116, 0))
        self.bad_chars_label.setAlignment(QtCore.Qt.AlignCenter)
        self.bad_chars_label.setObjectName(_fromUtf8("bad_chars_label"))
        self.horizontalLayout_5.addWidget(self.bad_chars_label)
        self.bad_chars_lineEdit = QtGui.QLineEdit(Dialog)
        self.bad_chars_lineEdit.setObjectName(_fromUtf8("bad_chars_lineEdit"))
        self.horizontalLayout_5.addWidget(self.bad_chars_lineEdit)
        self.encoder_label = QtGui.QLabel(Dialog)
        self.encoder_label.setObjectName(_fromUtf8("encoder_label"))
        self.horizontalLayout_5.addWidget(self.encoder_label)
        self.encoder_comboBox = QtGui.QComboBox(Dialog)
        self.encoder_comboBox.setObjectName(_fromUtf8("encoder_comboBox"))
        self.horizontalLayout_5.addWidget(self.encoder_comboBox)
        self.encoder_label_3 = QtGui.QLabel(Dialog)
        self.encoder_label_3.setObjectName(_fromUtf8("encoder_label_3"))
        self.horizontalLayout_5.addWidget(self.encoder_label_3)
        self.exit_func_comboBox = QtGui.QComboBox(Dialog)
        self.exit_func_comboBox.setObjectName(_fromUtf8("exit_func_comboBox"))
        self.horizontalLayout_5.addWidget(self.exit_func_comboBox)
        self.verticalLayout.addLayout(self.horizontalLayout_5)
        self.textBrowser = QtGui.QTextBrowser(Dialog)
        self.textBrowser.setObjectName(_fromUtf8("textBrowser"))
        self.verticalLayout.addWidget(self.textBrowser)
        self.label_3 = QtGui.QLabel(Dialog)
        self.label_3.setObjectName(_fromUtf8("label_3"))
        self.verticalLayout.addWidget(self.label_3)
        self.horizontalLayout_6 = QtGui.QHBoxLayout()
        self.horizontalLayout_6.setObjectName(_fromUtf8("horizontalLayout_6"))
        self.clear_pushButton = QtGui.QPushButton(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.clear_pushButton.sizePolicy().hasHeightForWidth())
        self.clear_pushButton.setSizePolicy(sizePolicy)
        self.clear_pushButton.setMinimumSize(QtCore.QSize(85, 27))
        self.clear_pushButton.setObjectName(_fromUtf8("clear_pushButton"))
        self.horizontalLayout_6.addWidget(self.clear_pushButton)
        self.generate_pushButton = QtGui.QPushButton(Dialog)
        sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Minimum, QtGui.QSizePolicy.Minimum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.generate_pushButton.sizePolicy().hasHeightForWidth())
        self.generate_pushButton.setSizePolicy(sizePolicy)
        self.generate_pushButton.setMinimumSize(QtCore.QSize(85, 27))
        self.generate_pushButton.setObjectName(_fromUtf8("generate_pushButton"))
        self.horizontalLayout_6.addWidget(self.generate_pushButton)
        self.verticalLayout.addLayout(self.horizontalLayout_6)
        self.init_buttons()
        self.init_comboboxes()
        self.retranslateUi(Dialog)
        QtCore.QMetaObject.connectSlotsByName(Dialog)

    def retranslateUi(self, Dialog):
        Dialog.setWindowTitle(_translate("Dialog", "Dialog", None))
        self.pc_label.setText(_translate("Dialog", "Pattern Create", None))
        self.pc_bytes_label.setText(_translate("Dialog", "# bytes", None))
        self.pc_out_label.setText(_translate("Dialog", "Output Pattern", None))
        self.pc_create_pushButton.setText(_translate("Dialog", "Create", None))
        self.poffset_label.setText(_translate("Dialog", "Pattern Offset", None))
        self.poffset_bytes_label.setText(_translate("Dialog", "# bytes", None))
        self.pattern_in_label.setText(_translate("Dialog", "pattern", None))
        self.pc_out_label_2.setText(_translate("Dialog", "Offset Output", None))
        self.pc_locate_pushButton.setText(_translate("Dialog", "Locate", None))
        self.b64_enc_label.setText(_translate("Dialog", "Base64 Encode", None))
        self.b64_encode_pushButton.setText(_translate("Dialog", "Encode", None))
        self.b64_encoded_out_label.setText(_translate("Dialog", "Encoded Output", None))
        self.b64_enc_label_2.setText(_translate("Dialog", "Base64 Decode", None))
        self.b64_encode_pushButton_2.setText(_translate("Dialog", "Decode", None))
        self.b64_decoded_out_label.setText(_translate("Dialog", "Decoded Output", None))
        self.payload_label.setText(_translate("Dialog", "Payload", None))
        self.lhost_label.setText(_translate("Dialog", "LHOST", None))
        self.lport_label.setText(_translate("Dialog", "LPORT", None))
        self.format_label.setText(_translate("Dialog", "Format", None))
        self.fout_label.setText(_translate("Dialog", "File Path", None))
        self.browse_fout_pushButton.setText(_translate("Dialog", "Browse", None))
        self.bad_chars_label.setText(_translate("Dialog", "Bad Chars", None))
        self.encoder_label.setText(_translate("Dialog", "Encoder", None))
        self.encoder_label_3.setText(_translate("Dialog", "ExitFunc", None))
        self.label_3.setText(_translate("Dialog", "Raw Out", None))
        self.clear_pushButton.setText(_translate("Dialog", "Clear", None))
        self.generate_pushButton.setText(_translate("Dialog", "Generate", None))
        
    def init_comboboxes(self):
        self.payload_comboBox.addItems(payloads)
        self.format_comboBox.addItems(payload_format)
        self.encoder_comboBox.addItems(encoders)
        self.exit_func_comboBox.addItems(exit_func_list)
        
    def init_buttons(self):
        self.pc_create_pushButton.clicked.connect(self.handlePCButton)
        self.pc_locate_pushButton.clicked.connect(self.handlePLButton)
        self.b64_encode_pushButton.clicked.connect(self.handle_b64_enc)
        self.b64_encode_pushButton_2.clicked.connect(self.handle_b64_dec)
        # print self.string_to_hex_encode('my test text!a')
        # print self.hex_to_string_decode('612174786574207473657420796d')
        ## YQAAAHMAAABkAAAAZgAAAGEAAABzAAAAZAAAAA==

        
    # method for creating a unique pattern for buffer overflow verification
    def getPatternCreate(self):
        num_bytes = str(self.pc_bytes_lineEdit.text())
        
        try:
            
            if not int(num_bytes) > 0:
                num_bytes = warning_msg
            else:
                outp=subprocess.Popen([pattern_create_path, '-l',num_bytes],stdout=subprocess.PIPE)
                
                num_bytes = outp.communicate()
                num_bytes = num_bytes[0].rstrip()
        except ValueError:
            num_bytes = warning_msg
        return num_bytes
    
    # method for locating number of bytes required to overwrite EIP/RIP with pattern created 
    def locateOffsetPattern(self):
        num_bytes = str(self.poffset_bytes_lineEdit.text())
        pattern = str(self.poffset_pattern_lineEdit.text())
        #test pattern - 'bytes:2048 pattern:41356241'
        
        try:
            
            if not int(num_bytes) > 0 or not int(pattern) > 0:
                num_bytes = warning_msg
            else:
                outp=subprocess.Popen([pattern_locate_path, '-l', num_bytes, '-q', pattern],stdout=subprocess.PIPE)
                
                num_bytes = outp.communicate()
                num_bytes = num_bytes[0]

        except ValueError:
            num_bytes = warning_msg

        return num_bytes

    #method for encoding ascii string to b64
    def handle_b64_enc(self):
        mytext = self.base64_enc()
        self.textBrowser_2.setText(mytext)

    #method for decoding b64 to ascii string
    def handle_b64_dec(self):
        mytext = self.base64_dec()
        self.b64_dec_textBrowser.setText(mytext)

    #method for reversing a string and converting it to numerical bytes
    def string_to_hex_encode(self,strval):
        return strval[::-1].encode('hex')
    
    #method for reversing a byte string to readable ascii string
    def hex_to_string_decode(self,strval):
        return strval.decode('hex')[::-1]
    
    # ~~~~~~~~~~~~~~~~~~~~~~~~Button Handlers~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    #b64 encode button handler
    def base64_enc(self):
        return base64.standard_b64encode(str(self.b64_encode_lineEdit.text()))
    
    #b64 decode button handler
    def base64_dec(self):
        #return 'out12'
        return base64.standard_b64decode(str(self.b64_decode_lineEdit.text()))
    
    #method for handling pattern locate
    def handlePLButton(self):
        mytext = self.locateOffsetPattern()
        self.pc_out_textBrowser_2.setText(mytext)

    #method for handling pattern create     
    def handlePCButton(self):
        mytext = self.getPatternCreate()
        self.pc_out_textBrowser.setText(mytext)

    # ~~~~~~~~~~~~~~~~~~~~~~~~Button Initialization~~~~~~~~~~~~~~~~~~~~~~~~~~~
    def init_buttons(self):
        self.pc_create_pushButton.clicked.connect(self.handlePCButton)
        self.pc_locate_pushButton.clicked.connect(self.handlePLButton)
        self.b64_encode_pushButton.clicked.connect(self.handle_b64_enc)
        self.b64_encode_pushButton_2.clicked.connect(self.handle_b64_dec)
        # print self.string_to_hex_encode('my test text!a')
        # print self.hex_to_string_decode('612174786574207473657420796d')
        ## YQAAAHMAAABkAAAAZgAAAGEAAABzAAAAZAAAAA==

if __name__ == "__main__":
    import sys
    app = QtGui.QApplication(sys.argv)
    Dialog = QtGui.QDialog()
    ui = Ui_Dialog()
    ui.setupUi(Dialog)
    Dialog.show()
    sys.exit(app.exec_())
